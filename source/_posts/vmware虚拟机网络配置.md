---
title: vmware虚拟机网络配置
tags:
  - vmware网络
categories:
  - linux
abbrlink: 300f2b
date: 2024-06-28 23:37:20
---

## vmwarme 网络类型
> VMware虚拟机有三种网络模式，分别是**Bridged(桥接模式)**、**NAT(网络地址转换模式)**、**Host-only(主机模式)**
> VMware workstation安装好之后会多出两个网络连接,分别是:
> **VMware Network Adapter VMnet1**
> **VMware Network Adapter VMnet8** 
> 上面这两个是可以在主机的网络连接中可以查看到的，
> 还有一个是**VMnet0**，可以在virtual network editor中看到
> 这三个虚拟网络都是VMware安装好之后自动生成的，不需要手动修改。
>> 其中VMnet0用于Bridged模式，VMnet1用于Host-only模式，Vmnet8用于NAT模式。VMnet8和VMnet1提供DHCP服务，VMnet0默认则不提供。

**图一**
![bridged](https://pic.imgdb.cn/item/667eddecd9c307b7e93831e0.png "图一")

## 1. Bridged 桥接模式 (VMnet0)
> 在这种模式下，VMWare虚拟出来的操作系统就像是局域网中的一台**独立的主机**，它可以访问网内任何一台机器，你需要手工为虚拟系统配置IP地址、子网掩码，而且还要和宿主机器处于同网段，这样虚拟系统才能和宿主机器进行通信，虚拟系统和宿主机器的关系，就像连接在同一个Hub上的两台电脑。从网络技术上理解相当于在宿主机前端加设了一个虚拟交换机，然后宿主机和所有虚拟机共享这个交换机。
- 如果你想利用VMWare在局域网内新建一个虚拟服务器，为局域网用户提供网络服务，就应该选择桥接模式。

### 1.1 桥接模式下的网络设置
> 1. 虚拟机网络设置：桥接模式（选择图一中的桥接模式）
> 2. 查看本机的以太网网络设置：ipconfig 
> 3. 配置虚拟机网络：
    - vim /etc/sysconfig/network-scripts/ifcfg-eth0
    - ip地址和本机同一个网段
    - 网关地址、子网掩码、DNS和本机一样即可
    - 重启虚拟机网卡
    - 测试：ping 本机或外网


## 2. NAT 网络地址转换模式 (VMnet8)
> NAT（Network Address Translation）网络地址转换，是一种网络技术，它允许一个网络中的计算机通过一个公共网络（如互联网）来通信。
> NAT技术通过将一个私有IP地址转换为一个公共IP地址来实现通信。
> NAT技术将一个私有IP地址转换为一个公共IP地址来实现通信。
> 这里的虚拟机NET模式：
>> 就是让虚拟系统借助NAT的功能，通过宿主机所在的网络来访问公网。在这种模式下宿主机成为双网卡主机，同时参与现有的宿主局域网和新建的虚拟局域网，但由于加设了一个虚拟的NAT服务器，使得虚拟局域网内的虚拟机在对外访问时，使用的则是宿主机的IP地址，这样从外部网络来看，只能看到宿主机，完全看不到新建的虚拟局域网。

> 采用NAT模式最大的优势是虚拟系统接入互联网非常简单，你不需要进行任何其他的配置，只需要宿主机器能访问互联网即可。
- 如果你想利用VMWare安装一个新的虚拟系统，在虚拟系统中不用进行任何手工配置就能直接访问互联网，建议你采用NAT模式。

### 2.1 NAT模式下的网络设置
> 1. 检查宿主机的VMware DHCP Service 和VMwareNAT Service两个服务是否启动：
![任务管理器](https://pic.imgdb.cn/item/667ee2b1d9c307b7e94130f2.png)

>2. 虚拟机网络选择设置：NAT模式（选择图一中的NAT模式）
>3. 虚拟机中网络配置：因为NAT有DHCP服务，所以我们只需要将BOOTPROTO参数设置为dhcp就可以了，由dhcp服务器分配IP地址。
>4. 注意如果虚拟机中网卡配置中有 **ONBOOT** 参数为no，那么虚拟机网卡不会自动启动，需要手动启动网卡、可以直接注销掉
- 默认情况下VMware和虚拟机的配置都不需要修改，所以NAT模式是最简单的
- 默认情况下会自动分配，当然你也也可以自行配置网段和网关、如下图：
![配置自定义net网络](https://pic.imgdb.cn/item/667ee8a1d9c307b7e94ab6ac.png)

- **注意**：如果将本机的**VMnet8**网卡禁掉的话就无法在本机远程（ssh）到虚拟主机了、但是可以ping通
· _这就是NET模式、利用虚拟的NET设备以及虚拟的DHCP服务器来使虚拟机连接外网、而VMnet8虚拟网卡是用来与虚拟机通信的_

## 3. Host-only 仅主机模式 (VMnet1)    
- 在某些特殊的网络调试环境中，要求将真实环境和虚拟环境隔离开，这时你就可采用host-only模式，在这种模式下宿主机上的所有虚拟机是可以相互通信的，但虚拟机和真实的网络是被隔离开的。
- 在这种模式下新建了一个由所有虚拟机与宿主机所构成的局域网，但该局域网与宿主机本身所处的现有局域网是相互独立的，如果不做额外路由设置，这两个局域网之间不会连通，因此新建的局域网可以认为是一个单独从属于当前宿主机的私有网络，其成员为当前宿主机和相关的所有虚拟机。
- 从网络技术上讲相当于为宿主机增添了一个虚拟网卡，让宿主机变成一台双网卡主机（宿主网卡+虚拟网卡）。同时在宿主机后端加设一个虚拟交换机，让宿主机和所有虚拟机构成另一个虚拟的局域网。由于具备双网卡，宿主机可同时参与两个局域网（现有的宿主局域网+新建的虚拟局域网），只不过缺省情况下两个局域网不连通。
- **如果你想利用VMWare创建一个与网内其他机器相隔离的虚拟系统，进行某些特殊的网络调试工作，可以选择host-only模式。**

### 3.1 Host-only模式下的网络设置
- Host-only模式下是由VMnet1网卡负责的，VMnet1提供DHCP服务，所以虚拟机中我们不需手动设定IP
> 1. 虚拟机网络设置：Host-only模式即可（选择图一中的Host-only模式）
> 2. 配置好后主机就能ping通虚拟机，但虚拟机ping主机时就要注意了，不是去ping宿主网卡产生的IP地址，而是由虚拟网卡VMnet1产生的IP地址，宿主机命令行中输入ipconfig就可看到VMnet1的产生的IP地址


[可参考: https://blog.51cto.com/u_15169172/2710721](https://blog.51cto.com/u_15169172/2710721)